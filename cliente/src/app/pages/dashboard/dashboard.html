<div class="d-flex justify-content-between align-items-center mb-3">
	<h3>Usuarios</h3>
	<button class="btn btn-primary" type="button" (click)="abrirModal()">Nuevo usuario</button>
</div>

<div class="row g-3">
	<div class="col-12 col-md-6" *ngFor="let u of listadoUsuarios">
		<div class="card p-3">
			<div class="d-flex align-items-center">
				<img *ngIf="u.imagenUrl"
					[src]="environment.apiUrl + u.imagenUrl"
					alt="avatar"
					width="48" height="48"
					class="rounded-circle me-3">
				
				<div>
					<strong>{{ u.nombre }} {{ u.apellido }}</strong>
					<div class="small">UserName: @{{ u.nombreUsuario }}  —  Correo: {{ u.correo }}</div>
					<div class="small text-muted">Perfil: {{ u.perfil }}</div>
					<div class="small text-muted">Estado: {{ u.activo === false ? 'Baja' : 'Activo' }}</div>
				</div>
			</div>

			<div class="mt-2 d-flex justify-content-end">
				<button class="btn" 
						[ngClass]="u.activo === 'baja' ? 'btn-success'  : 'btn-warning'" (click)="bajaAlta(u._id, u.activo)">
				{{ u.activo == false ? 'Alta' : 'Baja' }}
				</button>			
			</div>
		</div>
	</div>
</div>



<div *ngIf="modalAbierto" class="modal-overlay" (click)="cerrarModal()">
	
	<div class="modal show d-block" (click)="$event.stopPropagation()">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">

				<form [formGroup]="registroForm" (ngSubmit)="enviarFormulario()">

					<div class="modal-header">
						<h5 class="modal-title">Nuevo usuario</h5>
						<button type="button" class="btn-close" (click)="cerrarModal()" aria-label="Close"></button>
					</div>

					<div class="modal-body">

						<div class="row g-3">
							<div class="col-md-6">
								<label class="form-label">Nombre</label>
								<input class="form-control" type="text" formControlName="nombre">
							</div>

							<div class="col-md-6">
								<label class="form-label">Apellido</label>
								<input class="form-control" type="text" formControlName="apellido">
							</div>

							<div class="col-md-6">
								<label class="form-label">Email</label>
								<input class="form-control" type="email" formControlName="correo">
							</div>

							<div class="col-md-6">
								<label class="form-label">Nombre de usuario</label>
								<input class="form-control" type="text" formControlName="nombreUsuario">
							</div>

							<div class="col-md-6">
								<label class="form-label">Contraseña</label>
								<input class="form-control" type="password" formControlName="contrasena">
							</div>

							<div class="col-md-6">
								<label class="form-label">Fecha de nacimiento</label>
								<input class="form-control" type="date" formControlName="fechaNacimiento">
							</div>

							<div class="col-12">
								<label class="form-label">Descripción</label>
								<input class="form-control" type="text" formControlName="descripcion">
							</div>

							<div class="col-12">
								<label class="form-label">Imagen de perfil</label>
								<input class="form-control" type="file" (change)="onFileSelected($event)">
							</div>

							<div class="col-12">
								<label class="form-label me-3">Perfil:</label>

								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio"
										formControlName="perfil" value="usuario">
									<label class="form-check-label">Usuario</label>
								</div>

								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio"
										formControlName="perfil" value="admin">
									<label class="form-check-label">Administrador</label>
								</div>
							</div>
						</div>

					</div>

					<div class="modal-footer">
						<button type="button" class="btn btn-secondary" (click)="cerrarModal()">Cancelar</button>
						<button type="submit" class="btn btn-primary">Crear</button>
					</div>

				</form>

			</div>
		</div>
	</div>
</div>